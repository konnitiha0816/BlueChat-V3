<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlueChat V3</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend+Exa:wght@700&display=swap" rel="stylesheet">
    <style>
        /* --- åŸºæœ¬è¨­å®š & æ˜¼å¤œèƒŒæ™¯ --- */
        body { margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow: hidden; color: white; transition: background 2s; }
        
        /* æ—¥ä¸­ (5:00 - 17:00): ç¾ã—ã„é¢¨æ™¯ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ */
        .day-bg { background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 100%), url('https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?auto=format&fit=crop&w=1920&q=80'); background-size: cover; background-blend-mode: overlay; }
        
        /* å¤œé–“ (17:00 - 5:00): æš—ã„æ˜Ÿç©ºã®ã‚¤ãƒ¡ãƒ¼ã‚¸ */
        .night-bg { background: linear-gradient(to bottom, #09203f 0%, #537895 100%), url('https://images.unsplash.com/photo-1506318137071-a8e063b4bc04?auto=format&fit=crop&w=1920&q=80'); background-size: cover; background-blend-mode: overlay; }

        .hidden { display: none !important; }
        .v3-tag { position: fixed; top: 15px; right: 20px; font-size: 14px; font-weight: bold; opacity: 0.8; z-index: 100; }

        /* --- ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ --- */
        .full-screen { height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .title-text { font-family: 'Lexend Exa', sans-serif; font-size: clamp(40px, 10vw, 90px); text-shadow: 0 10px 30px rgba(0,0,0,0.4); margin-bottom: 30px; }
        .btn-main { padding: 15px 50px; font-size: 20px; border-radius: 50px; border: none; background: white; color: #0078d4; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.2); transition: 0.3s; }
        .btn-main:hover { transform: scale(1.05); background: #f0f0f0; }

        /* --- ãƒ‘ãƒãƒ«ï¼ˆå…±é€šï¼‰ --- */
        .glass-panel { background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px); padding: 30px; border-radius: 20px; width: 320px; border: 1px solid rgba(255,255,255,0.1); }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: none; box-sizing: border-box; font-size: 16px; }
        .link-blue { color: #4facfe; text-decoration: none; font-size: 13px; cursor: pointer; }

        /* --- é€šè©±UI (Google Meeté¢¨) --- */
        #screen-call { height: 100vh; background: #202124; display: flex; flex-direction: column; }
        .call-header { height: 48px; background: #000; display: flex; align-items: center; padding: 0 20px; font-size: 16px; font-weight: bold; }
        .video-main { flex: 1; display: flex; align-items: center; justify-content: center; position: relative; background: #3c4043; }
        #main-stream { width: 100%; height: 100%; object-fit: cover; }
        .call-info { position: absolute; bottom: 100px; left: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); }
        
        .control-bar { height: 80px; display: flex; justify-content: center; align-items: center; gap: 12px; }
        .icon-btn { width: 48px; height: 48px; border-radius: 50%; border: none; background: #3c4043; color: white; cursor: pointer; font-size: 20px; display: flex; align-items: center; justify-content: center; }
        .icon-btn.red { background: #ea4335; }
        .icon-btn:hover { background: #4a4d51; }

        /* --- ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼ˆãƒãƒ£ãƒƒãƒˆãƒ»ç®¡ç†ï¼‰ --- */
        .sidebar { position: fixed; right: 0; top: 0; width: 350px; height: 100%; background: white; color: #202124; z-index: 200; transform: translateX(350px); transition: 0.3s; padding: 20px; box-sizing: border-box; }
        .sidebar.open { transform: translateX(0); }
        #chat-msgs { height: 70%; overflow-y: auto; border-bottom: 1px solid #eee; margin-bottom: 10px; }
    </style>
</head>
<body class="day-bg">
    <div class="v3-tag">V3</div>

    <div id="screen-title" class="full-screen">
        <div class="title-text">Blue Chat</div>
        <button class="btn-main" onclick="startKuku()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    </div>

    <div id="screen-captcha" class="full-screen hidden">
        <div class="glass-panel">
            <h3>ğŸ¤– ãƒ­ãƒœãƒƒãƒˆèªè¨¼</h3>
            <p id="kuku-question" style="font-size: 24px; font-weight: bold;"></p>
            <input type="number" id="kuku-answer" placeholder="ç­”ãˆã‚’å…¥åŠ›">
            <button class="btn-main" style="width:100%; font-size: 16px;" onclick="checkKuku()">ç¢ºèª</button>
        </div>
    </div>

    <div id="screen-login" class="full-screen hidden">
        <div class="glass-panel">
            <button style="width:100%; padding:12px; margin-bottom:10px; border:none; border-radius:5px; cursor:pointer;">Googleã§ãƒ­ã‚°ã‚¤ãƒ³</button>
            <button style="width:100%; padding:12px; margin-bottom:20px; border:none; border-radius:5px; background:#0078d4; color:white; cursor:pointer;">Microsoftã§ãƒ­ã‚°ã‚¤ãƒ³</button>
            <div style="border-top: 1px solid rgba(255,255,255,0.2); margin-bottom: 20px;"></div>
            <input type="text" id="login-id" placeholder="BlueChat ID">
            <input type="password" id="login-pw" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
            <button class="btn-main" style="width:100%; font-size:16px; margin-top:10px;" onclick="doLogin()">ãƒ­ã‚°ã‚¤ãƒ³</button>
            <p><a class="link-blue" onclick="showRegister(1)">ãƒ–ãƒ«ãƒ¼ãƒãƒ£ãƒƒãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ</a></p>
        </div>
    </div>

    <div id="screen-reg-1" class="full-screen hidden">
        <div class="glass-panel">
            <h3>æ–°è¦ç™»éŒ² (1/2)</h3>
            <input type="text" id="reg-id" placeholder="ID (è‹±æ•°.-.)">
            <input type="password" id="reg-pw" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ (è‹±æ•°6æ–‡å­—ä»¥ä¸Š)">
            <button class="btn-main" style="width:100%; font-size:16px;" onclick="checkReg1()">æ¬¡ã¸</button>
        </div>
    </div>

    <div id="screen-reg-2" class="full-screen hidden">
        <div class="glass-panel">
            <h3>æ–°è¦ç™»éŒ² (2/2)</h3>
            <input type="text" id="reg-nick" placeholder="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ">
            <p style="font-size: 10px; color: #ffaaaa;">â€»æœ¬åã‚’ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„</p>
            <button class="btn-main" style="width:100%; font-size:16px;" onclick="finishRegister()">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ</button>
        </div>
    </div>

    <div id="screen-menu" class="full-screen hidden">
        <button class="btn-main" style="width:250px; margin-bottom:20px;" onclick="showCallMenu()">é€šè©±</button>
        <button class="btn-main" style="width:250px; background:rgba(255,255,255,0.5);" onclick="alert('ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä¸­')">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</button>
    </div>

    <div id="screen-prep" class="full-screen hidden" style="flex-direction: row; padding: 50px; gap: 40px;">
        <div style="flex: 2; background: #000; border-radius: 20px; overflow: hidden; height: 100%;">
            <video id="prep-video" autoplay muted playsinline style="width:100%; height:100%; object-fit: cover;"></video>
        </div>
        <div class="glass-panel" style="flex: 1; height: fit-content;">
            <h3 id="prep-room-name">é€šè©±ã®æº–å‚™</h3>
            <p>ã‚«ãƒ¡ãƒ©ãƒ»ãƒã‚¤ã‚¯ãƒ»å…±æœ‰è¨­å®š</p>
            <button class="btn-main" style="width:100%; background: #28a745; color: white;" onclick="enterCall()">é€šè©±ã‚’é–‹å§‹</button>
        </div>
    </div>

    <div id="screen-call" class="hidden">
        <div class="call-header">Blue Chat</div>
        <div class="video-main">
            <video id="main-stream" autoplay playsinline></video>
            <div class="call-info">
                <div id="call-clock">00:00:00</div>
                <div id="call-room-id" style="font-size: 12px; opacity: 0.8;">ID: ------</div>
            </div>
        </div>
        <div class="control-bar">
            <button class="icon-btn" title="ãƒã‚¤ã‚¯">ğŸ¤</button>
            <button class="icon-btn" title="ã‚«ãƒ¡ãƒ©">ğŸ“·</button>
            <button class="icon-btn" title="ç”»é¢å…±æœ‰">ğŸ“¤</button>
            <button class="icon-btn" title="æŒ™æ‰‹">âœ‹</button>
            <button class="icon-btn" onclick="toggleSidebar('chat')" title="ãƒãƒ£ãƒƒãƒˆ">ğŸ’¬</button>
            <button class="icon-btn" id="btn-admin-tool" onclick="toggleSidebar('admin')" title="ç®¡ç†">âš™ï¸</button>
            <button class="icon-btn" title="å‚åŠ è€…">ğŸ‘¥</button>
            <button class="icon-btn red" title="é€€å‡º">ğŸ“</button>
        </div>
        
        <div id="side-chat" class="sidebar">
            <h3>ãƒãƒ£ãƒƒãƒˆ</h3>
            <div id="chat-msgs"></div>
            <input type="text" id="chat-input" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ (@ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ )">
            <button class="btn-main" style="width:100%; font-size: 14px; padding: 8px;" onclick="sendMsg()">é€ä¿¡</button>
        </div>

        <div id="side-admin" class="sidebar">
            <h3>è¨­å®šãƒªã‚¹ãƒˆ</h3>
            <button onclick="adminAction('member')" style="width:100%; padding:10px; margin-bottom:5px;">ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†</button>
            <button onclick="adminAction('lock')" style="width:100%; padding:10px; margin-bottom:5px;">é€šè©±ãƒ­ãƒƒã‚¯</button>
            <button onclick="adminAction('kick-all')" style="width:100%; padding:10px; background:#ea4335; color:white;">å…¨å“¡å¼·åˆ¶é€€å‡º</button>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="client.js"></script>
</body>
</html>
